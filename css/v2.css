/* ========= Design tokens & type scale ========= */
:root {
  /* Spaziatura */
  --space-xxs: 4px;
  --space-xs: 6px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 20px;
  --space-2xl: 24px;

  /* Raggi / bordo */
  --radius: 18px;
  --radius-lg: 16px;
  --radius-xl: 20px;

  /* Ombre */
  --shadow-elev: 0 10px 30px rgba(0,0,0,.12);

  /* Tipografia fluida */
  --fz-h1: clamp(20px, 3.2vw, 34px);
  --fz-h3: clamp(16px, 2.6vw, 22px);
  --fz-body: clamp(14px, 2.2vw, 17px);
  --fz-input: 16px; /* ≥16px evita lo zoom iOS al focus */

  /* Colori */
  --bg:#fff;
  --text:#111827;
  --muted:#6b7280;
  --accent:#111827;
  --accent-light:#f9fafb;

  /* Colori UI neutrali */
  --ui-100:#f9fafb;
  --ui-200:#f3f4f6;
  --ui-300:#e5e7eb;
  --ui-700:#374151;
}

/* Anti-glitch iOS */
html { -webkit-text-size-adjust: 100%; }

/* ========= Base ========= */
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg); color:var(--text);
  font-size:15px; line-height:1.5;
}

/* Tipografia di default nel card */
#card h2, #card .title, .popup-title, .modal-title { font-size: var(--fz-h1); line-height: 1.2; }
#card h3, .box h3 { font-size: var(--fz-h3); line-height: 1.25; }
#card, #card p, #card li, #card label { font-size: var(--fz-body); line-height: 1.5; }
#card input, #card button, #card select, #card textarea { font-size: var(--fz-input); }

/* ========= Overlay & Card ========= */
.overlay{
  display:flex; justify-content:center; align-items:center;
  min-height:100vh; width:100%; background:transparent;
}
.card{
  position:relative; background:var(--bg); border-radius:var(--radius);
  box-shadow:none; padding:16px 0; max-width:740px; width:92vw; box-sizing:border-box;
}

/* ========= Header ========= */
.title{margin:0 0 2px; font-size:1.6rem; font-weight:700;}
.subtitle{margin:4px 0 18px; color:var(--muted); font-size:1rem;}

/* ========= Layout colonne ========= */
.grid{display:flex; gap:14px;}
.box{
  flex:1; padding:16px 14px;
  border:1px solid var(--ui-300); border-radius:14px; box-shadow:none; background:#fff;
}
.box--hl{background:var(--accent-light);}
h3{margin:0 0 8px;}
p{margin:0 0 12px;}

/* ========= Coupon ========= */
.code-block{
  display:flex; align-items:center; gap:10px;
  padding:10px 14px; background:var(--ui-100); border:none; border-radius:14px;
}
.code-label{
  display:inline-flex; align-items:center; justify-content:center;
  height:34px; padding:0 14px; border-radius:9999px; background:var(--ui-300);
  color:var(--ui-700); font-size:13px; font-weight:600; letter-spacing:.06em; text-transform:uppercase;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.35);
}
.code-value{
  display:inline-flex; align-items:center;
  height:34px; padding:0 14px; border-radius:10px; background:#fff;
  border:1px solid var(--ui-300);
  font-family:ui-monospace,Menlo,Consolas,monospace; font-weight:700; font-size:1.1rem; color:#111827;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.4);
}

/* ========= Forms ========= */
.inputs{display:flex; gap:8px;}
.input{
  width:100%; padding:9px 11px; border:1px solid var(--ui-300); border-radius:10px;
  font-size:.95rem; box-sizing:border-box; box-shadow:none; background:#fff;
}
.btn{
  border:none; border-radius:10px; padding:9px 14px; font-weight:600; cursor:pointer;
  transition:opacity .2s ease; box-shadow:none;
}
.btn.primary{background:var(--accent); color:#fff;}
.btn.secondary{background:#fff; color:var(--accent); border:1px solid var(--accent);}
.btn:hover{opacity:.9;}

/* ========= GDPR (checkbox + label) ========= */
.consent{ margin-top:14px; }

.consent__label{
  display:flex;
  align-items:center;            /* centrato verticalmente */
  gap:10px;
  font-size:.78rem;
  color:#111827;
  cursor:pointer;
  line-height:1.45;              /* baseline stabile su più righe */
}

.consent__label input[type="checkbox"]{
  flex:0 0 auto;
  width:18px; height:18px;
  margin:0;                      /* togli sfasamento */
  translate:0 0;                 /* anti-zoom iOS */
  border:1px solid #cbd5e1; border-radius:4px;
  appearance:none; outline:0; background:#fff;
}

.consent__label input[type="checkbox"]:checked{
  background:#111827; border-color:#111827;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 16 12' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23fff' d='M6.2 11.1L.9 5.8l1.6-1.6 3.7 3.7L13.5.6l1.6 1.6z'/%3E%3C/svg%3E");
  background-repeat:no-repeat; background-position:center; background-size:12px;
}

.consent__fineprint{ display:block; margin-top:6px; font-size:.78rem; color:#6b7280; }
.consent__fineprint a{ color:inherit; text-decoration:underline; }

/* ========= Close & misc ========= */
.close{ position:absolute; top:22px; right:22px; background:none; border:none; font-size:1rem; cursor:pointer; opacity:.7; transition:opacity .2s; }
.close:hover{ opacity:1; }
.toast{ font-size:.9rem; margin-top:6px; color:var(--muted); }
.fineprint{ margin-top:20px; font-size:.8rem; color:var(--muted); text-align:center; line-height:1.4; }

/* ========= Spinner sul bottone ========= */
.btn.is-loading { position: relative; opacity: .6; cursor: wait; pointer-events: none; padding-right: 34px; }
.btn.is-loading::after {
  content: ""; position: absolute; right: 12px; top: 50%;
  width: 14px; height: 14px; margin-top: -7px;
  border: 2px solid currentColor; border-top-color: transparent;
  border-radius: 50%; animation: lp-spin 0.9s linear infinite;
}
@keyframes lp-spin { to { transform: rotate(360deg); } }

/* ========= Desktop: 2 colonne stabili ========= */
.lp-grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-2xl);
  align-items: start;
}

/* Fallback grid se il wrapper contiene due .box */
#card > *:has(> .box:nth-child(2)):not(.lp-grid-2) {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-2xl);
}

/* Card generali */
#card { max-width: clamp(720px, 86vw, 1080px); margin: 0 auto; }
#card .box { padding: var(--space-xl); border-radius: var(--radius-xl); }

/* Close desktop */
#card .close-btn, .modal-close, .popup-close {
  width: 28px; height: 28px; line-height: 28px; font-size: 18px;
}

/* ========= Breakpoints ========= */

/* ≤ 980px: respiro minore */
@media (max-width: 980px) {
  #card { max-width: 92vw; }
  .lp-grid-2, #card > *:has(> .box:nth-child(2)):not(.lp-grid-2) { gap: var(--space-xl); }
}

/* ≤ 720px: passa a 1 colonna, compattazione controllata */
@media (max-width: 720px) {
  .lp-grid-2, #card > *:has(> .box:nth-child(2)):not(.lp-grid-2) {
    grid-template-columns: 1fr;
    gap: var(--space-lg);
  }
  .card{ padding:14px 12px; width:96vw; }
  .box{ padding:14px 12px; }
  .title{ font-size: clamp(18px, 5vw, 24px); }
  .subtitle{ font-size: clamp(13px, 3.6vw, 15px); margin-bottom: 12px; }
}

/* ≤ 500px: riduci paddings e tipografia senza triggerare zoom iOS */
@media (max-width: 500px) {
  .inputs{ flex-direction:column; gap:8px; }
  .code-block{ padding:8px 10px; }
  .code-label{ height:32px; padding:0 12px; font-size:12px; }
  .code-value{ height:32px; padding:0 12px; font-size:1rem; }
  .btn{ padding:10px 12px; }
  .consent{ margin-top:10px; }
  .consent__label{ font-size:.76rem; gap:10px; }        /* testo leggermente più piccolo */
  .consent__label input[type="checkbox"]{ width:16px; height:16px; }
}

/* ≤ 380px: “SE-friendly” */
@media (max-width: 380px) {
  .card{ width:98vw; padding:12px 10px; }
  .box{ padding:12px 10px; }
  .title{ font-size: clamp(17px, 6vw, 21px); }
  .subtitle{ font-size: 13px; }
  .code-label{ height:30px; padding:0 10px; font-size:11px; }
  .code-value{ height:30px; padding:0 10px; font-size:.95rem; }
  .btn{ padding:10px 10px; }
}

/* ≥ 981px: micro-reduzione testi privacy/marketing su desktop */
@media (min-width: 981px) {
  .consent__label{ font-size:.72rem; }                 /* ancora un filo più piccoli */
  .consent__fineprint{ font-size:.70rem; }
  .consent__label input[type="checkbox"]{ width:16px; height:16px; }
}

/* =========================
   Mobile accordion (<=559px)
   ========================= */
@media (max-width: 559px) {
  /* Stack layout */
  .grid { display: block !important; }

  /* Respiro card */
  #card { padding: 16px !important; border-radius: 16px !important; }

  /* Box compatti */
  .box { margin: 12px 0 !important; padding: 14px !important; border-radius: 14px !important; }

  /* Titoli box */
  .box h3,
  [data-i18n="left_title"],
  [data-i18n="right_title"] {
    font-size: 18px !important;
    line-height: 1.25 !important;
    margin-bottom: 8px !important;
  }

  /* ---------- Shell accordion ---------- */
  .lp-acc-section {
    border: 1px solid rgba(0,0,0,0.06);
    border-radius: 14px;
    background: #fff;
    margin: 10px 0;
    overflow: hidden;
  }

  .lp-acc-trigger {
    -webkit-appearance: none; appearance: none;
    width: 100%; text-align: left; border: 0;
    background: var(--ui-200); color: var(--text);
    font: inherit; padding: 14px 16px;
    display: flex; align-items: center; justify-content: space-between; gap: 12px;
    cursor: pointer; border-bottom: 1px solid var(--ui-300);
  }

  .lp-acc-title { font-weight: 700; font-size: 16px; line-height: 1.25; }
  .lp-acc-caret { color: currentColor; transition: transform .25s ease; }

  .lp-acc-section.is-open .lp-acc-trigger {
    background: var(--accent); color: #fff; border-bottom-color: transparent;
  }
  .lp-acc-section.is-open .lp-acc-caret { transform: rotate(180deg); }

  .lp-acc-panel { overflow: hidden; max-height: 0; transition: max-height .30s ease; background: #fff; }
  .lp-acc-section.is-open > .lp-acc-panel { max-height: 2000px; }

  .lp-acc-panel > .box {
    margin: 0 !important; border: 0 !important; border-radius: 0 !important; padding: 14px !important;
  }

  /* Inputs/buttons più stretti */
  #leadForm input, #leadForm button, #copyBtn {
    min-height: 40px !important; padding: 10px 12px !important; font-size: 15px !important;
  }

  #formNotice, #copyToast { margin: 8px 0 !important; }
}

/* ≥ 560px: l’accordion non altera il layout desktop */
@media (min-width: 560px) {
  .lp-acc-trigger { display: none !important; }
  .lp-acc-panel { max-height: none !important; overflow: visible !important; border-top: 0 !important; }
  .lp-acc-section { border: 0 !important; margin: 0 !important; background: transparent !important; }
}

/* === Mobile: niente titolo duplicato all'interno dei pannelli === */
@media (max-width: 559px) {
  .lp-acc-panel .box h3 { display: none !important; }
}